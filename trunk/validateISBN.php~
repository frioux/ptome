<?php

/**
 *   Validates ISBN numbers
 *   
 *
 *  @param   isbn  an ISBN number as a string
 *  @return        0 - Valid
 *                 1 - Invalid
 *                 2 - Wrong length
 */

function validateISBN($isbn)
{

   if(strlen($isbn) == 13) 
   {
      $k = 0;
      for($i = 0; $i < 6; $i++)
      {
         $evenSum += intval($isbn[$k]);
         $k = $k + 2;
      }

      $k = 1;
      for($i = 0; $i < 6; $i++)
      {
         $oddSum += (3*intval($isbn[$k]));
         $k = $k + 2;
      }

      $checkValue = 10 - (($oddSum + $evenSum) % 10);

      if($checkValue == 10)
      {
         $checkValue = 0;
      }
   }
   else if (strlen($isbn) == 10)
   {
      for($i = 1; $i < 10; $i++)
      {
         $sum += intval($isbn[$i-1]) * $i;
      }

      $checkValue = ($sum % 11);

      if($checkValue == 11)
      {
         $checkValue = 0;
      }
      else if($checkValue == 10)
      {
         $checkValue = "X";
      }
   }
   else
   {
      return 2;
   }

   if(intval($isbn[strlen($isbn)-1]) == intval($checkValue))
   {
      return 0;
   } 
   else 
   {
      return 1;
   }
}

?>
